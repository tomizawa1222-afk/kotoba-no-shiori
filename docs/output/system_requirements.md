# システム要件定義書

## システム概要
「言葉の栞（ことばのしおり）」は、読書体験の中で出会う「心に刺さった一行」を記録・共有することに特化したSNSです。感想文全体ではなく、特定のフレーズ（言葉）を栞のように保存し、感性で繋がる新しい読書コミュニティを創出します。

1. **システムの目的**
   - **解決する課題:** 既存のSNSでは長文感想が投稿しづらく、読書管理アプリは事務的すぎるという、デジタルネイティブ世代（20-30代）の不満を解消する。
   - **目標とする成果:** 「本」単位ではなく「言葉」単位での新しい本との出会いと、共感ベースのコミュニティの構築。
   - **ビジネスインパクト:** 若年層の読書人口の取り込みと、書籍購入（EC）への導線確保。

2. **主な機能**
   - **コア機能:**
     - 引用投稿（書籍検索・出典記録・タグ付け）
     - タイムライン（フォロー・おすすめ表示）
     - 検索（カテゴリ・トレンドタグ）
   - **差別化機能:**
     - デザインシステム（白黒ミニマル＋感情を表すイエローグラデーション）
     - ページ数記録による信頼性担保
   - **付加価値機能:**
     - 読書ステータス管理（積読/読書中/読了）
     - 統計・レポート機能

3. **提供する価値**
   - **ユーザー:** 読書メモの美しいデジタル化、感性の合う他者との繋がり、新しい本との偶然の出会い。
   - **ビジネス:** アフィリエイト収益、プレミアムプラン、出版社タイアップなどの収益基盤。

4. **実現方法の概要**
   - **テクノロジー:** モダンなWeb技術（Next.js）を用いたPWA（Progressive Web App）としての展開を想定し、ネイティブアプリに近いUXを実現。
   - **インテグレーション:** Google Books API / OpenBD（書誌情報）、各種ASP（アフィリエイト）。

## 情報の前提と仮定
- **情報源:** `読書SNS「言葉の栞」詳細機能仕様書とデザインシステム.html` (v1.1)
- **仮定:**
  - 元仕様書ではモバイルアプリ（Flutter/React Native）とされていますが、現在の開発環境およびプロンプトの推奨構成に基づき、**Next.js (Web/PWA)** での実装を前提に再構成します。
  - 初期ターゲットは20-30代のデジタルネイティブ層とし、モバイルデバイスでの利用を最優先します。

## 機能要件

### 1. 認証・ユーザー管理
- **アカウント作成・ログイン:** メールアドレス、SNSアカウントによる認証（Clerk利用）。
- **プロフィール管理:** アイコン、ユーザー名、自己紹介、Webサイトリンクの設定。
- **プライバシー設定:** 公開/フォロワー限定/非公開の設定。

### 2. 投稿機能 (Post)
- **引用作成:**
  - テキスト入力（最大文字数制限あり、例: 500文字）。
  - **書籍検索:** Google Books API等を利用し、タイトル・著者・ISBNから書籍を特定・紐付け。
  - **出典記録:** ページ番号の記録（任意）。
  - **タグ付け:** トピックタグ（#人生 #恋愛 など）の付与。
- **ステータス:** 下書き保存、公開範囲設定。

### 3. 閲覧・発見 (Feed & Search)
- **タイムライン:**
  - フォロー中ユーザーの投稿表示。
  - トレンド・おすすめアルゴリズムによる投稿表示。
  - 無限スクロールによる快適な閲覧。
- **検索:**
  - キーワード検索（本、著者、タグ、ユーザー、引用文）。
  - トレンドタグのバブル表示。
  - サジェスト機能。

### 4. リアクション・交流
- **アクション:** いいね（ハート）、保存（ブックマーク）。
- **コメント:** 投稿へのコメント機能。
- **シェア:** 外部SNSへのシェア機能。

### 5. 本棚・記録 (Bookshelf)
- **読書管理:** 読んだ本、積読、読書中のステータス管理。
- **統計:** 累計投稿数、読了冊数の可視化。

## 非機能要件

1. **ユーザビリティ・UI/UX**
   - **レスポンス:** 主要操作（いいね、ページ遷移）は0.1秒以内の即時反応（Optimistic UI）を目指す。
   - **デザイン:** 「Minimal & Energetic」コンセプトの徹底。白黒ベースにイエローグラデーションのアクセント。
   - **モバイルファースト:** スマートフォンでの操作性を最優先したUI設計。

2. **信頼性・可用性**
   - **データ保全:** 投稿データおよび読書記録の確実な永続化。
   - **稼働率:** 99.9%以上の稼働目標。

3. **セキュリティ・コンプライアンス**
   - **著作権対応:** 引用要件（出典明記、主従関係など）を満たす投稿フォーマットの強制。
   - **不適切コンテンツ:** NGワードフィルターおよび通報機能の実装。

4. **スケーラビリティ**
   - **ユーザー規模:** 初期1,000人〜フェーズ2で50,000人規模のMAUに耐えうるアーキテクチャ。

## 技術スタック

元仕様書のモバイルアプリ構成（Flutter/Go）を、現在の開発トレンドおよびWeb展開の容易さを考慮し、以下のモダンスタックに再定義します。

- **フロントエンド:** **Next.js (App Router)**
  - **選定理由:** SEOに強く、PWA対応によりモバイルアプリに近い体験を提供可能。Reactのエコシステムを活用でき、開発効率が高い。
- **言語:** **TypeScript**
  - **選定理由:** 型安全性による保守性の向上とバグ削減。
- **スタイリング:** **Tailwind CSS**
  - **選定理由:** デザインシステムの「白黒＋アクセント」を効率的に実装・管理するため。
- **バックエンド/データベース:** **Supabase (PostgreSQL)**
  - **選定理由:**
    - 元仕様のRDBMS（ユーザー・書籍）とNoSQL（ログ・タイムライン）の要件を、PostgreSQLとJSONB、およびRealtime機能でカバー可能。
    - 認証、DB、ストレージが統合されており、MVP開発の速度を最大化できる。
- **認証:** **Clerk**
  - **選定理由:** 認証UI/UXの品質が高く、Next.jsとの親和性が非常に高い。ソーシャルログイン実装工数の削減。
- **インフラ/ホスティング:** **Vercel**
  - **選定理由:** Next.jsの最適化ホスティング、CI/CDの自動化。

## 開発ロードマップ

### Phase 1: MVP (Month 0-3)
- **目的:** コア価値の検証と初期ユーザー獲得。
- **実装機能:**
  - 認証（Clerk）
  - 引用投稿（書籍API連携含む）
  - タイムライン（新着順）
  - 基本的なプロフィール
  - 検索（簡易版）

### Phase 2: 機能拡張 (Month 4-6)
- **目的:** リテンション向上と体験のリッチ化。
- **実装機能:**
  - 画像添付機能（OCR検討）
  - 下書き保存
  - トレンド・おすすめアルゴリズム
  - 通知機能
  - PWAとしてのインストール導線強化

### Phase 3: コミュニティ化 (Month 7-12)
- **目的:** コミュニティの活性化と収益化基盤の構築。
- **実装機能:**
  - コメント・メンション機能
  - グループ機能（読書会）
  - アフィリエイト連携
  - 統計・レポート機能拡充

## リスク分析

1. **法的・コンプライアンスリスク（高）**
   - **内容:** ユーザーによる著作権侵害（引用の範囲を超える投稿）。
   - **対策:** 投稿画面での出典入力の必須化、ガイドラインの明示、通報・削除プロセスの確立。

2. **ビジネスリスク（中）**
   - **内容:** ユーザー定着率の低迷。
   - **対策:** 「いいね」やリアクションによる承認欲求の充足、プッシュ通知によるリテンション施策。

3. **技術的リスク（低）**
   - **内容:** 書籍API（Google Books等）の制限やデータ不備。
   - **対策:** 複数のAPI併用（OpenBD等）や、ユーザーによる手動入力補完の許容。

## UI/UXの方向性
- **デザインコンセプト:** 「Minimal & Energetic」
- **カラーパレット:**
  - Base: White (#FFFFFF), Black (#000000)
  - Surface: Gray (#F5F5F5)
  - Accent: Linear Gradient (#FFFC00 to #FFA500)
- **タイポグラフィ:** Noto Sans JP, San Francisco (System Fonts)
- **トーン＆マナー:** 知的だが気取らない、エモーショナル。
- **参考:** UPSTAR（ミニマリズム）、Snapchat/Instagram Stories（エネルギッシュなアクセント）

## 追加情報リクエスト
1. **収益化の詳細（中）**
   - Phase 2以降のアフィリエイトリンクの実装方針（全書籍に自動付与か、ユーザー任意か）。
2. **OCR機能の要件（低）**
   - Phase 2で予定されている画像からのテキスト抽出（OCR）について、具体的な精度要件や利用APIの想定。

